<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="What your mother never told you about cufflinks" />
<meta property="og:description" content="In this post, I am trying to nail down the &ldquo;best&rdquo; way to run cufflinks, part of the so-called &ldquo;tuxedo suite&rdquo; of RNA-Seq tools (tophat, cufflinks, etc.)
I have a dataset composed of 3 technical replicates &ndash; exactly the same library, run in 3 separate hi-seq lanes (multiplexed along with other samples, but I am ignoring those for now.) They were run on an Illumina HiSeq 2000, with 101 bp paired-end reads." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://biocozy.net/posts/2013-01-30-what-your-mother-never-told-you-about-cufflinks/" />



<meta property="article:published_time" content="2013-01-30T17:48:00-08:00"/>

<meta property="article:modified_time" content="2013-01-30T17:48:00-08:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="What your mother never told you about cufflinks"/>
<meta name="twitter:description" content="In this post, I am trying to nail down the &ldquo;best&rdquo; way to run cufflinks, part of the so-called &ldquo;tuxedo suite&rdquo; of RNA-Seq tools (tophat, cufflinks, etc.)
I have a dataset composed of 3 technical replicates &ndash; exactly the same library, run in 3 separate hi-seq lanes (multiplexed along with other samples, but I am ignoring those for now.) They were run on an Illumina HiSeq 2000, with 101 bp paired-end reads."/>



    <link rel="canonical" href="https://biocozy.net/posts/2013-01-30-what-your-mother-never-told-you-about-cufflinks/">

    <title>
      
        What your mother never told you about cufflinks | Biocozy.net
      
    </title>

    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

    <link href="https://biocozy.net/css/style.css" rel="stylesheet">

    

    

    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120822435-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-120822435-1');
</script>

  </head>
  <body>
    
      <header class="blog-header">
    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <a class="navbar-brand" href="/">
            Biocozy.net
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
            <ul class="navbar-nav">
                
                
                <li class="nav-item ">
                    <a class="nav-link" href="/">Home</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">About</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/contact/">Contact</a>
                </li>
                
            </ul>
            
        </div>
    </nav>
</header>
    

    
    <div class="container">
      <div class="row">
        <div class="col-12 col-lg-8 blog-main">

          

<header>
    <h2 class="blog-post-title">
        <a class="text-dark" href="/posts/2013-01-30-what-your-mother-never-told-you-about-cufflinks/">What your mother never told you about cufflinks</a>
    </h2>
    


<div class="blog-post-date text-secondary">
    
        Jan 30, 2013
    
    
        by <span rel="author">Owen</span>
    
</div>

    
    
    <hr>
</header>
<article class="blog-post">
    <p>In this post, I am trying to nail down the &ldquo;best&rdquo; way to run cufflinks,
part of the so-called &ldquo;tuxedo suite&rdquo; of RNA-Seq tools (tophat,
cufflinks, etc.)</p>

<p>I have a dataset composed of 3 technical replicates &ndash; exactly the same
library, run in 3 separate hi-seq lanes (multiplexed along with other
samples, but I am ignoring those for now.) They were run on an Illumina
HiSeq 2000, with 101 bp paired-end reads.</p>

<p>Number of reads, before and after quality trimming and preprocessing:</p>

<p><span style="font-family: Courier New, Courier, monospace;">Replicate  
Before      After</span><br />
<span style="font-family: Courier New, Courier, monospace;">1        
  19,939,455  </span><span
style="font-family: 'Courier New', Courier, monospace;">19,074,425</span><br />
<span style="font-family: Courier New, Courier, monospace;">2        
  19,929,909</span><span
style="font-family: 'Courier New', Courier, monospace;">  </span><span
style="font-family: 'Courier New', Courier, monospace;">19,120,424</span><br />
<span style="font-family: Courier New, Courier, monospace;">3        
  19,950,587  </span><span
style="font-family: 'Courier New', Courier, monospace;">19,101,188</span><br />
<span style="font-family: inherit;">You can see, the lanes were very
uniform in the number of reads.</span><br />
<span style="font-family: inherit;"><br />
</span><span style="font-family: inherit;">For all of the following
commands, I am using the iGenomes files (for the bowtie2 index, the GTF
file, and the genome.fa file), available here: </span><br />
<a href="http://ccb.jhu.edu/software/tophat/igenomes.shtml">http://ccb.jhu.edu/software/tophat/igenomes.shtml</a></p>

<p><span style="font-family: inherit;">I ran tophat like this:</span><br />
<span style="font-family: Courier New, Courier, monospace;">tophat -G
genes.gtf &ndash;transcriptome-index=transcriptome -p 8 -o out genome
rep1_1.fq.gz rep1_2.fq.gz</span><br />
<span style="font-family: inherit;"><br />
</span><span style="font-family: inherit;">Cufflinks was run like
this:</span><br />
<span style="font-family: Courier New, Courier, monospace;">cufflinks -p
24 <span
style="background-color: yellow;">&ndash;no-effective-length-correction</span>
<span style="background-color: #ead1dc;">-b genome.fa</span> -G
genes.gtf -o out out/accepted_hits.bam</span><br />
<span style="font-family: inherit;"><br />
</span><span style="font-family: inherit;">The two variables are
highlighted.  </span><br />
<span style="font-family: inherit;"><br />
</span><span style="font-family: inherit;">The cufflinks online manual
says (note, &ldquo;Cuffdiff&rdquo; is a typo and should read &ldquo;Cufflinks&rdquo;)</span><br />
<span style="font-family: inherit;"><br />
</span></p>

<table>
<tbody>
<tr class="odd">
<td><code style="font-family: &#39;Courier New&#39;, Courier, monospace; margin: 0px; padding: 0px;">--no-effective-length-correction</code></td>
<td>Cuffdiff will not employ its &quot;effective&quot; length normalization to transcript FPKM.</td>
</tr>
</tbody>
</table>

<p>and:</p>

<table>
<tbody>
<tr class="odd">
<td><code style="font-family: &#39;Courier New&#39;, Courier, monospace; margin: 0px; padding: 0px;">-b/--frag-bias-correct </code></td>
<td>Providing Cufflinks with the multifasta file your reads were mapped to via this option instructs it to run our bias detection and correction algorithm which can significantly improve accuracy of transcript abundance estimates. See <a href="http://cole-trapnell-lab.github.io/cufflinks/how_it_works/index.html">How Cufflinks Works</a> for more details.</td>
</tr>
</tbody>
</table>

<p>For each run, I sorted the resulting genes.fpkm_tracking files, pulled
out the FPKM column, and calculated the mean of the pairwise Pearson
correlation for the 3 replicates. Here are the results:</p>

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="odd">
<td><div class="MsoNormal">
effective length corr
</div></td>
<td><div class="MsoNormal">
fragment bias corr
</div></td>
<td><div class="MsoNormal">
Time
</div></td>
<td><div class="MsoNormal">
Correlation
</div></td>
</tr>
<tr class="even">
<td><div class="MsoNormal">
Yes
</div></td>
<td><div class="MsoNormal">
Yes
</div></td>
<td><div class="MsoNormal">
43 min
</div></td>
<td><div class="MsoNormal">
0.9790755
</div></td>
</tr>
<tr class="odd">
<td><div class="MsoNormal">
Yes
</div></td>
<td><div class="MsoNormal">
No
</div></td>
<td><div class="MsoNormal">
16 min
</div></td>
<td><div class="MsoNormal">
0.9749819
</div></td>
</tr>
<tr class="even">
<td><div class="MsoNormal">
No
</div></td>
<td><div class="MsoNormal">
Yes
</div></td>
<td><div class="MsoNormal">
43 min
</div></td>
<td><div class="MsoNormal">
0.9999465
</div></td>
</tr>
<tr class="odd">
<td><div class="MsoNormal">
No
</div></td>
<td><div class="MsoNormal">
No
</div></td>
<td><div class="MsoNormal">
16 min
</div></td>
<td><div class="MsoNormal">
0.9999626
</div></td>
</tr>
</tbody>
</table>

<p>Note: the effective length correction is on by default, whereas the frag
bias correction is off by default.</p>

<p><strong>The best way to run cufflinks is with &ndash;no-effective-length-correction
!!!</strong><br />
**<br />
frag-bias-correction makes the analysis much slower, without any
discernable benefit in this trial run.**</p>


    

    


</article>



        </div>

        <aside class="col-12 col-lg-3 ml-auto blog-sidebar">
    
        


    
    
        <section>
    
        
    
        
    
        
    
        
        <h4>Tags</h4>
        <p>
            
            <a class="badge badge-primary" href="/tags/algorithms">algorithms</a>
            
            <a class="badge badge-primary" href="/tags/annotation">annotation</a>
            
            <a class="badge badge-primary" href="/tags/bioconductor">bioconductor</a>
            
            <a class="badge badge-primary" href="/tags/bioinformatics">bioinformatics</a>
            
            <a class="badge badge-primary" href="/tags/cart">cart</a>
            
            <a class="badge badge-primary" href="/tags/computers">computers</a>
            
            <a class="badge badge-primary" href="/tags/data-mining">data-mining</a>
            
            <a class="badge badge-primary" href="/tags/genomics">genomics</a>
            
            <a class="badge badge-primary" href="/tags/geo">geo</a>
            
            <a class="badge badge-primary" href="/tags/installation">installation</a>
            
            <a class="badge badge-primary" href="/tags/linux">linux</a>
            
            <a class="badge badge-primary" href="/tags/mac-os-x">mac-os-x</a>
            
            <a class="badge badge-primary" href="/tags/machine-learning">machine-learning</a>
            
            <a class="badge badge-primary" href="/tags/ngs">ngs</a>
            
            <a class="badge badge-primary" href="/tags/parallel-computing">parallel-computing</a>
            
            <a class="badge badge-primary" href="/tags/perl">perl</a>
            
            <a class="badge badge-primary" href="/tags/r">r</a>
            
            <a class="badge badge-primary" href="/tags/r-project">r-project</a>
            
            <a class="badge badge-primary" href="/tags/rnaseq">rnaseq</a>
            
            <a class="badge badge-primary" href="/tags/shell">shell</a>
            
            <a class="badge badge-primary" href="/tags/ubuntu">ubuntu</a>
            
            <a class="badge badge-primary" href="/tags/work">work</a>
            
            <a class="badge badge-primary" href="/tags/workaround">workaround</a>
            
        </p>
        
    
</section>
    
</aside>

      </div>
    </div>
    

    
      






<footer class="blog-footer w-100">
    <nav class="navbar navbar-light bg-light">
        <p class="w-100 text-center">Copyright Biocozy.net</p>
        <p class="w-100 text-center"><a href="#">Back to top</a></p>
    </nav>
</footer>

    

    
    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
  </body>
</html>
